(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 14.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     47527,       1093]
NotebookOptionsPosition[     45940,       1063]
NotebookOutlinePosition[     46361,       1079]
CellTagsIndexPosition[     46318,       1076]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "findExactCover", "]"}], ";"}], "\n", 
 RowBox[{"findExactCover", "=", 
  RowBox[{"ResourceFunction", "[", "\"\<FindExactCover\>\"", "]"}]}]}], "Code",
 CellChangeTimes->{{3.932345192654836*^9, 3.932345197875871*^9}, {
  3.932345457267488*^9, 3.932345480418108*^9}, {3.932912604879053*^9, 
  3.932912616201233*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"ae7dbb3d-f3e9-ba47-bdae-55be73e79ce4"],

Cell[BoxData[
 InterpretationBox[
  TagBox[
   TagBox[
    DynamicModuleBox[{Typeset`open = False}, 
     FrameBox[
      PaneSelectorBox[{False->GridBox[{
         {
          PaneBox[GridBox[{
             {
              StyleBox[
               StyleBox[
                AdjustmentBox["\<\"[\[FilledSmallSquare]]\"\>",
                 BoxBaselineShift->-0.25,
                 BoxMargins->{{0, 0}, {-1, -1}}], "ResourceFunctionIcon",
                
                FontColor->RGBColor[
                 0.8745098039215686, 0.2784313725490196, 0.03137254901960784]],
               ShowStringCharacters->False,
               FontFamily->"Source Sans Pro Black",
               FontSize->0.6538461538461539 Inherited,
               FontWeight->"Heavy",
               PrivateFontOptions->{"OperatorSubstitution"->False}], 
              StyleBox[
               RowBox[{
                StyleBox["FindExactCover", "ResourceFunctionLabel"], " "}],
               ShowAutoStyles->False,
               ShowStringCharacters->False,
               FontSize->Rational[12, 13] Inherited,
               FontColor->GrayLevel[0.1]]}
            },
            GridBoxSpacings->{"Columns" -> {{0.25}}}],
           Alignment->Left,
           BaseStyle->{LineSpacing -> {0, 0}, LineBreakWithin -> False},
           BaselinePosition->Baseline,
           FrameMargins->{{3, 0}, {0, 0}}], 
          ItemBox[
           PaneBox[
            TogglerBox[Dynamic[Typeset`open], {True->
             
             DynamicBox[FEPrivate`FrontEndResource[
              "FEBitmaps", "IconizeCloser"],
              ImageSizeCache->{11., {2., 9.}}], False->
             
             DynamicBox[FEPrivate`FrontEndResource[
              "FEBitmaps", "IconizeOpener"],
              ImageSizeCache->{11., {2., 9.}}]},
             Appearance->None,
             BaselinePosition->Baseline,
             ContentPadding->False,
             FrameMargins->0],
            Alignment->Left,
            BaselinePosition->Baseline,
            FrameMargins->{{1, 1}, {0, 0}}],
           Frame->{{
              RGBColor[
              0.8313725490196079, 0.8470588235294118, 0.8509803921568627, 
               0.5], False}, {False, False}}]}
        },
        BaselinePosition->{1, 1},
        GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
        GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
        GridBoxSpacings->{"Columns" -> {{0}}, "Rows" -> {{0}}}], True->
       GridBox[{
         {GridBox[{
            {
             PaneBox[GridBox[{
                {
                 StyleBox[
                  AdjustmentBox[
                   
                   StyleBox["\<\"[\[FilledSmallSquare]]\"\>", 
                    "ResourceFunctionIcon",
                    
                    FontColor->RGBColor[
                    0.8745098039215686, 0.2784313725490196, 
                    0.03137254901960784]],
                   BoxBaselineShift->-0.25,
                   BoxMargins->{{0, 0}, {-1, -1}}],
                  ShowStringCharacters->False,
                  FontFamily->"Source Sans Pro Black",
                  FontSize->0.6538461538461539 Inherited,
                  FontWeight->"Heavy",
                  PrivateFontOptions->{"OperatorSubstitution"->False}], 
                 StyleBox[
                  RowBox[{
                   StyleBox["FindExactCover", "ResourceFunctionLabel"], " "}],
                  ShowAutoStyles->False,
                  ShowStringCharacters->False,
                  FontSize->Rational[12, 13] Inherited,
                  FontColor->GrayLevel[0.1]]}
               },
               GridBoxSpacings->{"Columns" -> {{0.25}}}],
              Alignment->Left,
              BaseStyle->{LineSpacing -> {0, 0}, LineBreakWithin -> False},
              BaselinePosition->Baseline,
              FrameMargins->{{3, 0}, {0, 0}}], 
             ItemBox[
              PaneBox[
               TogglerBox[Dynamic[Typeset`open], {True->
                DynamicBox[FEPrivate`FrontEndResource[
                 "FEBitmaps", "IconizeCloser"]], False->
                
                DynamicBox[FEPrivate`FrontEndResource[
                 "FEBitmaps", "IconizeOpener"]]},
                Appearance->None,
                BaselinePosition->Baseline,
                ContentPadding->False,
                FrameMargins->0],
               Alignment->Left,
               BaselinePosition->Baseline,
               FrameMargins->{{1, 1}, {0, 0}}],
              Frame->{{
                 RGBColor[
                 0.8313725490196079, 0.8470588235294118, 0.8509803921568627, 
                  0.5], False}, {False, False}}]}
           },
           BaselinePosition->{1, 1},
           GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
           
           GridBoxItemSize->{
            "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}},
           GridBoxSpacings->{"Columns" -> {{0}}, "Rows" -> {{0}}}]},
         {
          StyleBox[
           PaneBox[GridBox[{
              {
               RowBox[{
                TagBox["\<\"Version (latest): \"\>",
                 "IconizedLabel"], " ", 
                TagBox["\<\"1.0.0\"\>",
                 "IconizedItem"]}]},
              {
               TagBox[
                
                TemplateBox[{
                 "\"Documentation \[RightGuillemet]\"", 
                  "https://resources.wolframcloud.com/FunctionRepository/\
resources/8af3735d-76fd-44a4-979c-0e02c18aea78/"},
                 "HyperlinkURL"],
                "IconizedItem"]}
             },
             DefaultBaseStyle->"Column",
             GridBoxAlignment->{"Columns" -> {{Left}}},
             
             GridBoxItemSize->{
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
            Alignment->Left,
            BaselinePosition->Baseline,
            FrameMargins->{{5, 4}, {0, 4}}], "DialogStyle",
           FontFamily->"Roboto",
           FontSize->11]}
        },
        BaselinePosition->{1, 1},
        GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
        GridBoxDividers->{"Columns" -> {{None}}, "Rows" -> {False, {
             GrayLevel[0.8]}, False}},
        GridBoxItemSize->{
         "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}]}, Dynamic[
       Typeset`open],
       BaselinePosition->Baseline,
       ImageSize->Automatic],
      Background->RGBColor[
       0.9686274509803922, 0.9764705882352941, 0.984313725490196],
      BaselinePosition->Baseline,
      DefaultBaseStyle->{},
      FrameMargins->{{0, 0}, {1, 0}},
      FrameStyle->RGBColor[
       0.8313725490196079, 0.8470588235294118, 0.8509803921568627],
      RoundingRadius->4]],
    #& ,
    TagBoxNote->" "],
   {"FunctionResourceBox", 
    RGBColor[0.8745098039215686, 0.2784313725490196, 0.03137254901960784], 
    "FindExactCover"},
   TagBoxNote->"FunctionResourceBox"],
  ResourceFunction[
   ResourceObject[<|
    "Name" -> "FindExactCover", "ShortName" -> "FindExactCover", "UUID" -> 
     "8af3735d-76fd-44a4-979c-0e02c18aea78", "ResourceType" -> "Function", 
     "Version" -> "1.0.0", "Description" -> 
     "Find row subsets of an input binary matrix that sum to 1 in each \
column", "RepositoryLocation" -> 
     URL["https://www.wolframcloud.com/obj/resourcesystem/api/1.0"], 
     "SymbolName" -> 
     "FunctionRepository`$b854fa09bfa44599bfb8881bb76fdbbb`FindExactCover", 
     "FunctionLocation" -> 
     CloudObject[
      "https://www.wolframcloud.com/obj/2db611ad-2b71-4d10-a439-ae7169205850"]\
|>, ResourceSystemBase -> Automatic]],
  Selectable->False]], "Output",
 CellChangeTimes->{3.9329127860747185`*^9},
 CellLabel->"Out[2]=",ExpressionUUID->"cc9648ac-43ac-5f43-b6b4-495332361dcf"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{"ClearAll", "[", "rotatePiece", "]"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"rotatePiece", "[", 
     RowBox[{"pieces_List", ",", "direction_List"}], "]"}], ":=", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"dir1", "=", 
         RowBox[{"direction", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ",", 
        RowBox[{"dir2", "=", 
         RowBox[{"direction", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ",", "pieceSize", ",", "center", 
        ",", "centeredPieces", ",", "rotationAngle1", ",", "rotationVector1", 
        ",", "rotationAngle2", ",", "rotationVector2", ",", 
        "rotatedCenteredPieces", ",", "rotatedPieces"}], "}"}], ",", "\n", 
      "\t", 
      RowBox[{
       RowBox[{"pieceSize", "=", 
        RowBox[{"Max", "[", 
         RowBox[{"Flatten", "[", "pieces", "]"}], "]"}]}], ";", "\n", "\t", 
       RowBox[{"center", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"pieceSize", "+", "1"}], ")"}], "/", "2"}]}], ";", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"centeredPieces", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "-", "center"}], "&"}], "/@", "pieces"}]}], ";", " ", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"rotationAngle1", "=", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{"dir1", "<=", "4"}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"dir1", "-", "1"}], ")"}], "*", "90", "\[Degree]"}], ",", 
          RowBox[{"dir1", "==", "5"}], ",", 
          RowBox[{"90", "\[Degree]"}], ",", 
          RowBox[{"dir1", "==", "6"}], ",", 
          RowBox[{"270", "\[Degree]"}]}], "]"}]}], ";", "\n", "\t", 
       RowBox[{"rotationVector1", "=", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{"dir1", "<=", "4"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
          RowBox[{
           RowBox[{"dir1", "==", "5"}], "||", 
           RowBox[{"dir1", "==", "6"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"rotationAngle2", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"dir2", "-", "1"}], ")"}], "*", "90", "\[Degree]"}]}], ";", 
       "\[IndentingNewLine]", "\t", 
       RowBox[{"rotationVector2", "=", 
        RowBox[{"Switch", "[", 
         RowBox[{"dir1", ",", "1", ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", "2", ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", "3", ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", "4", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "0", ",", "0"}], "}"}], ",", "5", ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", "6", ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", 
            RowBox[{"-", "1"}]}], "}"}]}], "]"}]}], ";", "\n", "\t", 
       RowBox[{"rotatedCenteredPieces", "=", 
        RowBox[{
         RowBox[{"RotationTransform", "[", 
          RowBox[{"rotationAngle2", ",", "rotationVector2"}], "]"}], "[", 
         RowBox[{
          RowBox[{"RotationTransform", "[", 
           RowBox[{"rotationAngle1", ",", "rotationVector1"}], "]"}], "[", 
          "centeredPieces", "]"}], "]"}]}], ";", "\n", "\t", 
       RowBox[{"rotatedPieces", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "+", "center"}], "&"}], "/@", 
         "rotatedCenteredPieces"}]}], ";", "\n", "\t", "rotatedPieces"}]}], 
     "]"}]}], ";"}], " "}]}], "Code",
 CellChangeTimes->{{3.932244845668672*^9, 3.932244998801641*^9}, {
   3.932245142819013*^9, 3.932245144266884*^9}, {3.932379993765157*^9, 
   3.932380003765842*^9}, {3.932386385338854*^9, 3.9323864259914703`*^9}, 
   3.932387091359188*^9},
 CellLabel->"In[3]:=",ExpressionUUID->"bb04d7e6-964c-c94a-8f7d-be03ae2f732e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "moveToOrigin", "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"moveToOrigin", "[", "piece_List", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"minX", ",", "minY", ",", "minZ"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"minX", "=", 
      RowBox[{"Min", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "&"}], "/@", "piece"}], "]"}]}], 
     ";", 
     RowBox[{"minY", "=", 
      RowBox[{"Min", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "&"}], "/@", "piece"}], "]"}]}], 
     ";", 
     RowBox[{"minZ", "=", 
      RowBox[{"Min", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "3", "]"}], "]"}], "&"}], "/@", "piece"}], "]"}]}], 
     ";", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"#", "-", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"minX", "-", "1"}], ",", 
           RowBox[{"minY", "-", "1"}], ",", 
           RowBox[{"minZ", "-", "1"}]}], "}"}]}], ")"}], "&"}], "/@", 
      "piece"}]}]}], "]"}]}]}], "Code",
 CellChangeTimes->{{3.9322464504012127`*^9, 3.932246703658236*^9}, {
  3.932247105923732*^9, 3.932247120631199*^9}, {3.9322471680805407`*^9, 
  3.932247168482373*^9}, {3.9322472321565304`*^9, 3.932247234935297*^9}, {
  3.9322473108204327`*^9, 3.932247330311003*^9}, {3.932247386436222*^9, 
  3.932247426287924*^9}, {3.9329127039273853`*^9, 3.9329127155066338`*^9}},
 CellLabel->"In[5]:=",ExpressionUUID->"62d7a02c-fbd2-1c48-846b-a956741c7f84"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "findAllPiecePositions", "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"findAllPiecePositions", "[", 
    RowBox[{"piece_List", ",", "cubeSize_Integer"}], "]"}], ":=", "\n", "\t", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "standardizedPiece", ",", "pieceSize", ",", "rotationsAtOrigin", ",", 
       "pieceAtOrigin", ",", "sizeDiff", ",", "allPositions"}], "}"}], ",", 
     "\n", "\t", 
     RowBox[{
      RowBox[{"pieceAtOrigin", "=", 
       RowBox[{"moveToOrigin", "[", "piece", "]"}]}], ";", "\n", "\t", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"rotationsAtOrigin", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"rotatePiece", "[", 
            RowBox[{"pieceAtOrigin", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"Quotient", "[", 
                 RowBox[{
                  RowBox[{"i", "-", "1"}], ",", "6"}], "]"}], "+", "1"}], ",", 
               RowBox[{
                RowBox[{"Mod", "[", 
                 RowBox[{
                  RowBox[{"i", "-", "1"}], ",", "4"}], "]"}], "+", "1"}]}], 
              "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "24"}], "}"}]}], "]"}]}], ";"}], "*)"}], "\n", 
      "\t", 
      RowBox[{"rotationsAtOrigin", "=", 
       RowBox[{"moveToOrigin", "/@", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"rotatePiece", "[", 
             RowBox[{"pieceAtOrigin", ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "j"}], "}"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "6"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "4"}], "}"}]}], "]"}], ",", "1"}], "]"}]}]}], 
      ";", "\n", "\t", 
      RowBox[{"pieceSize", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Max", "[", "#", "]"}], "-", " ", 
            RowBox[{"Min", "[", "#", "]"}], "+", "1"}], ")"}], "&"}], ",", 
         RowBox[{"Transpose", "/@", "rotationsAtOrigin"}], ",", 
         RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", "\t", 
      RowBox[{"sizeDiff", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"cubeSize", "-", "#", "+", "1"}], ")"}], "&"}], "/@", 
        "pieceSize"}]}], ";", "\n", "\t", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"allPositions", "=", 
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"#", "+", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"x", "-", "1"}], ",", 
                    RowBox[{"y", "-", "1"}], ",", 
                    RowBox[{"z", "-", "1"}]}], "}"}]}], "&"}], "/@", "#"}], 
               ",", 
               RowBox[{"{", 
                RowBox[{"x", ",", 
                 RowBox[{"sizeDiff", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"y", ",", 
                 RowBox[{"sizeDiff", "[", 
                  RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"z", ",", 
                 RowBox[{"sizeDiff", "[", 
                  RowBox[{"[", "3", "]"}], "]"}]}], "}"}]}], "]"}], "&"}], "/@",
             "rotationsAtOrigin"}], ",", "3"}], "]"}]}], ";"}], "*)"}], 
      "\[IndentingNewLine]", "\t", 
      RowBox[{"allPositions", "=", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{"MapIndexed", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"#1", "+", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"x", "-", "1"}], ",", 
                   RowBox[{"y", "-", "1"}], ",", 
                   RowBox[{"z", "-", "1"}]}], "}"}]}], "&"}], "/@", "#1"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"x", ",", 
                RowBox[{"sizeDiff", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"First", "[", "#2", "]"}], ",", "1"}], "]"}], 
                 "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"y", ",", 
                RowBox[{"sizeDiff", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"First", "[", "#2", "]"}], ",", "2"}], "]"}], 
                 "]"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"z", ",", 
                RowBox[{"sizeDiff", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"First", "[", "#2", "]"}], ",", "3"}], "]"}], 
                 "]"}]}], "}"}]}], "]"}], "&"}], ",", "rotationsAtOrigin"}], 
          "]"}], ",", "3"}], "]"}]}], ";", "\n", "\t", "allPositions"}]}], 
    "]"}]}], ";"}]}], "Code",
 CellChangeTimes->{{3.932245640588045*^9, 3.9322457466326923`*^9}, {
   3.932246229640346*^9, 3.932246239156732*^9}, 3.93224632355686*^9, {
   3.932247760237219*^9, 3.932247802476404*^9}, {3.932248058837684*^9, 
   3.932248135627977*^9}, {3.932248165983904*^9, 3.93224822451026*^9}, {
   3.932249904706774*^9, 3.932249910148571*^9}, {3.932250047790565*^9, 
   3.932250180408313*^9}, 3.932250464859667*^9, {3.932250506486412*^9, 
   3.932250662696258*^9}, {3.932250995428896*^9, 3.932251124195039*^9}, {
   3.9322513129879513`*^9, 3.932251313753156*^9}, {3.932252985313639*^9, 
   3.932252988765566*^9}, {3.932253200932167*^9, 3.932253204784546*^9}, {
   3.932253317630918*^9, 3.932253378141689*^9}, 3.932253415062538*^9, {
   3.932254102248781*^9, 3.932254116331495*^9}, {3.932254721234726*^9, 
   3.932254773391861*^9}, {3.932288958017763*^9, 3.932288958480697*^9}, {
   3.932289143017837*^9, 3.932289146604194*^9}, {3.932289199841446*^9, 
   3.932289203069464*^9}, {3.9322892345800323`*^9, 3.9322892359753*^9}, {
   3.932289311046284*^9, 3.932289341923233*^9}, {3.932289373293768*^9, 
   3.932289405364876*^9}, {3.9323862293720813`*^9, 3.932386263497085*^9}, {
   3.932388046138897*^9, 3.932388047977486*^9}, {3.932388199522592*^9, 
   3.932388203631876*^9}, {3.932390016667341*^9, 3.93239010879295*^9}, {
   3.932747891463932*^9, 3.9327478923442483`*^9}, {3.932747984045687*^9, 
   3.9327480146681366`*^9}, {3.9327495682727833`*^9, 3.93274957957333*^9}, {
   3.9327496144891167`*^9, 3.9327496225723705`*^9}, {3.932749669524315*^9, 
   3.932749697660982*^9}, {3.932749981839754*^9, 3.932750082366464*^9}, {
   3.9327501170413914`*^9, 3.932750118125904*^9}, {3.932750258034321*^9, 
   3.9327502879544067`*^9}, {3.932750726582779*^9, 3.9327507344125023`*^9}, {
   3.932764066354147*^9, 3.9327640679680786`*^9}, {3.932766471201919*^9, 
   3.9327664851403923`*^9}, {3.932767121860758*^9, 3.932767125146496*^9}, {
   3.932767198481415*^9, 3.9327672025130196`*^9}, {3.932767246397674*^9, 
   3.932767294082077*^9}, {3.932767352371845*^9, 3.932767353531063*^9}, {
   3.9327678279496136`*^9, 3.932767829141269*^9}, {3.932767996870723*^9, 
   3.932768003176479*^9}, {3.932768213677133*^9, 3.93276821517606*^9}, {
   3.932768255978363*^9, 3.932768318544147*^9}, 3.932768423355301*^9, {
   3.932769068604578*^9, 3.9327690825101337`*^9}, {3.932770691663824*^9, 
   3.932770704079204*^9}, {3.9327708730449543`*^9, 3.932770874024328*^9}, {
   3.932770955719137*^9, 3.932770956871573*^9}, {3.932770990615715*^9, 
   3.932771022211319*^9}, {3.9327710872998333`*^9, 3.932771113706941*^9}, {
   3.932771555343937*^9, 3.9327715602616844`*^9}, {3.932771629508226*^9, 
   3.932771632565916*^9}, {3.932771701811952*^9, 3.9327717065763454`*^9}, {
   3.93277180410495*^9, 3.9327718229732933`*^9}, {3.932771983598507*^9, 
   3.9327720170910873`*^9}, {3.932772095985079*^9, 3.9327721445965633`*^9}, {
   3.93277219575708*^9, 3.9327722299513264`*^9}, 3.932772771740703*^9, 
   3.932772912734173*^9, {3.932773065462921*^9, 3.932773073730842*^9}, {
   3.932773993095909*^9, 3.932774001112583*^9}, {3.932895524680996*^9, 
   3.932895528321525*^9}},
 CellLabel->"In[7]:=",ExpressionUUID->"916de741-14fb-3949-914a-f3cb10979ab2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "createOccupancyList", "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"createOccupancyList", "[", 
    RowBox[{"position_List", ",", "cubeSize_Integer"}], "]"}], ":=", "\n", 
   "\t", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "occupancyList", "}"}], ",", "\n", "\t", 
     RowBox[{
      RowBox[{"occupancyList", "=", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"0", ",", 
         RowBox[{"{", 
          RowBox[{"cubeSize", ",", "cubeSize", ",", "cubeSize"}], "}"}]}], 
        "]"}]}], ";", "\n", "\t", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"occupancyList", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "3", "]"}], "]"}], ",", 
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", 
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], "=", "1"}], 
         ")"}], "&"}], "/@", "position"}], ";", "\n", "\t", 
      RowBox[{"Flatten", "[", "occupancyList", "]"}]}]}], "]"}]}], 
  ";"}]}], "Code",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBmIQ7bPCNj7b560j85LWRBB9YYFWG4hOaJzTDqINXgSs
ANExbmIrQfSPoHU/QHQmtytrDkjcT4ETRH/I3iEMohPYV3uC6MDKXb4g+kL8
vTQQfX7i8nQQfdZDKBdEr3nXmw+i7WyOFoPoO8YtJSC64opYC9i805ltIHrH
i0/TQTTHp8QZIPq6uPk8EG2T9Q1ML/m05AyI3sIfdx5EW9/f80XW963j/EnL
voLoiklljOpA+gPrflYQvcXUkgtEi9fb84HoPVm3+rWBdOyS3okgesbL5adB
9GW/0DMgeknzFNV0IF1ww0gNRAMAjHuTVA==
  "],
 CellLabel->"In[9]:=",ExpressionUUID->"5edbcc78-926b-204f-9acb-ce5dfa5a57fd"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "createOccupancyRows", "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"createOccupancyRows", "[", 
   RowBox[{"piece_List", ",", "cubeSize_Integer"}], "]"}], ":=", "\n", "\t", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"positions", ",", "rows", ",", "uniqueRows"}], "}"}], ",", "\n", 
    "\t", 
    RowBox[{
     RowBox[{"positions", "=", 
      RowBox[{"findAllPiecePositions", "[", 
       RowBox[{"piece", ",", "cubeSize"}], "]"}]}], ";", "\n", "\t", 
     RowBox[{"rows", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"createOccupancyList", "[", 
         RowBox[{"#", ",", "cubeSize"}], "]"}], "&"}], "/@", "positions"}]}], 
     ";", "\n", "\t", 
     RowBox[{"uniqueRows", "=", 
      RowBox[{"DeleteDuplicates", "[", "rows", "]"}]}], ";", "\n", "\t", 
     "uniqueRows"}]}], "]"}]}]}], "Code",
 CellChangeTimes->{{3.932382983997642*^9, 3.932383009340658*^9}, {
   3.932383053789207*^9, 3.932383126566808*^9}, {3.9323833188394394`*^9, 
   3.932383366238909*^9}, {3.932383436662281*^9, 3.932383437564583*^9}, {
   3.932383936772884*^9, 3.9323840512885284`*^9}, {3.932402300324108*^9, 
   3.932402315513202*^9}, {3.932745624216324*^9, 3.932745631732515*^9}, {
   3.932747939393669*^9, 3.932747960239776*^9}, {3.93276398434289*^9, 
   3.9327639868084164`*^9}, {3.932764078928268*^9, 3.932764101566803*^9}, 
   3.932764154500961*^9, 3.932764251384186*^9, 3.9327647428836994`*^9, {
   3.932773529278072*^9, 3.932773533206209*^9}, 3.9327737910528374`*^9, {
   3.9327738541759624`*^9, 3.9327738556315975`*^9}, {3.93289554708889*^9, 
   3.932895550489706*^9}, {3.932895612350389*^9, 3.932895615347351*^9}},
 CellLabel->"In[11]:=",ExpressionUUID->"7c8621e4-93fa-b14d-87c3-c17d763876f1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "createOccupancyMatrix", "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"createOccupancyMatrix", "[", 
    RowBox[{"pieces_List", ",", "cubeSize_Integer"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "pieceCount", "}"}], ",", 
     RowBox[{
      RowBox[{"pieceCount", "=", 
       RowBox[{"Length", "[", "pieces", "]"}]}], ";", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"UnitVector", "[", 
               RowBox[{"pieceCount", ",", "i"}], "]"}], ",", "#"}], "]"}], 
            "&"}], "/@", 
           RowBox[{"createOccupancyRows", "[", 
            RowBox[{
             RowBox[{"pieces", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", "cubeSize"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "pieceCount"}], "}"}]}], "]"}], ",", "1"}], 
       "]"}]}]}], "]"}]}], ";"}]}], "Code",
 CellChangeTimes->{{3.932402267390941*^9, 3.932402274464695*^9}, 
   3.932402404538908*^9, {3.932402450684644*^9, 3.932402529551786*^9}, {
   3.93240346862146*^9, 3.932403519487686*^9}, {3.9324035586994305`*^9, 
   3.932403569567633*^9}, {3.932403637928682*^9, 3.932403663316248*^9}, {
   3.932745050909437*^9, 3.9327450783349724`*^9}, {3.93274794769178*^9, 
   3.932747964166324*^9}, {3.9327735374483757`*^9, 3.9327735396845193`*^9}, {
   3.93277381373308*^9, 3.932773815535324*^9}, {3.932895555261923*^9, 
   3.932895559302265*^9}, 3.932895654639423*^9},
 CellLabel->"In[13]:=",ExpressionUUID->"0a90f1ad-476e-2e4f-8231-a689c0735d4b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "webInputToCoords", "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"webInputToCoords", "[", 
    RowBox[{"pieceMatrix_List", ",", "cubeSize_Integer"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "reversedCoords", "}"}], ",", 
     RowBox[{
      RowBox[{"reversedCoords", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{"#", ",", "True"}], "]"}], "&"}], ",", "pieceMatrix"}], 
        "]"}]}], ";", 
      RowBox[{"Map", "[", 
       RowBox[{"Reverse", ",", "reversedCoords", ",", 
        RowBox[{"{", "2", "}"}]}], "]"}]}]}], "]"}]}], ";"}]}], "Code",
 CellChangeTimes->{{3.9327265375200233`*^9, 3.9327265808353443`*^9}, {
   3.932726717502846*^9, 3.932726770181084*^9}, {3.932726848564804*^9, 
   3.932726858117369*^9}, {3.932776453356802*^9, 3.932776480661115*^9}, {
   3.932891321963846*^9, 3.932891332629768*^9}, {3.932891372363081*^9, 
   3.932891372905678*^9}, {3.932891423137325*^9, 3.9328914304353247`*^9}, {
   3.9328914633589087`*^9, 3.932891488032728*^9}, {3.9328918212444305`*^9, 
   3.932891838080715*^9}, {3.932891885761898*^9, 3.932891887445692*^9}, {
   3.932892265450203*^9, 3.932892267956043*^9}, 3.932892346571516*^9, {
   3.932892386191162*^9, 3.932892398681274*^9}, {3.932892835326147*^9, 
   3.932892900229982*^9}, {3.932892942379261*^9, 3.932892971673574*^9}, {
   3.932893019809511*^9, 3.93289303329862*^9}, {3.932895574172159*^9, 
   3.932895577768257*^9}, {3.932911848016648*^9, 3.932911849969403*^9}},
 CellLabel->"In[15]:=",ExpressionUUID->"8a4e95b6-305b-a441-8d47-288c6de76ecf"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"This", " ", "function", " ", 
    RowBox[{"isn", "'"}], "t", " ", "working", " ", "for", " ", "who", " ", 
    "knows", " ", "what", " ", "reason"}], "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"ClearAll", " ", "solvePuzzle"}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"solvePuzzle", "[", 
      RowBox[{"webInput_List", ",", "cubeSize_Integer"}], "]"}], ":=", "\n", 
     "\t", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "pieceCount", ",", "coordList", ",", "rawSolution", ",", 
         "reducedSolution", ",", "oneHotSolution", ",", "flatSolution", ",", 
         "nestedSolution"}], "}"}], ",", "\n", "\t", 
       RowBox[{
        RowBox[{"pieceCount", "=", 
         RowBox[{"Length", "[", "webInput", "]"}]}], ";", "\n", "\t", 
        RowBox[{"coordList", "=", 
         RowBox[{"webInputToCoords", "[", 
          RowBox[{"webInput", ",", "cubeSize"}], "]"}]}], ";", "\n", "\t", 
        RowBox[{"rawSolution", "=", 
         RowBox[{"findExactCover", "[", 
          RowBox[{"createOccupancyMatrix", "[", 
           RowBox[{"coordList", ",", "cubeSize"}], "]"}], "]"}]}], ";", "\n", 
        "\t", 
        RowBox[{"reducedSolution", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Drop", "[", 
            RowBox[{"#", ",", "pieceCount"}], "]"}], "&"}], "/@", 
          RowBox[{"SortBy", "[", 
           RowBox[{"rawSolution", ",", 
            RowBox[{
             RowBox[{"FirstPosition", "[", 
              RowBox[{"#", ",", "1"}], "]"}], "&"}]}], "]"}]}]}], ";", "\n", 
        "\t", 
        RowBox[{"oneHotSolution", "=", 
         RowBox[{"Transpose", "[", "reducedSolution", "]"}]}], ";", "\n", 
        "\t", 
        RowBox[{"flatSolution", "=", 
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"FirstPosition", "[", 
             RowBox[{"#", ",", "1"}], "]"}], "&"}], "/@", "oneHotSolution"}], 
          "]"}]}], ";", "\n", "\t", 
        RowBox[{"nestedSolution", "=", 
         RowBox[{"Partition", "[", 
          RowBox[{
           RowBox[{"Partition", "[", 
            RowBox[{"flatSolution", ",", "cubeSize"}], "]"}], ",", 
           "cubeSize"}], "]"}]}], ";", "\n", "\t", "nestedSolution"}]}], 
      "]"}]}], ";"}]}]}]], "Code",
 CellChangeTimes->{{3.932585574758093*^9, 3.932585607535856*^9}, {
   3.932585681999138*^9, 3.9325856887368164`*^9}, {3.932585739353756*^9, 
   3.9325857432905865`*^9}, {3.932585930531853*^9, 3.932585953841728*^9}, {
   3.932586098284069*^9, 3.932586133121706*^9}, {3.9325862841870346`*^9, 
   3.932586289118852*^9}, {3.932586332783584*^9, 3.932586357070606*^9}, {
   3.9325867305299835`*^9, 3.932586736618355*^9}, {3.9325870155665836`*^9, 
   3.932587069107508*^9}, {3.932727958787949*^9, 3.9327279666468983`*^9}, {
   3.9327750709453983`*^9, 3.932775084242832*^9}, {3.9327758255742226`*^9, 
   3.9327758662571926`*^9}, {3.9327759425493183`*^9, 3.93277594585824*^9}, 
   3.932775993729412*^9, {3.932776082107485*^9, 3.932776126016706*^9}, {
   3.9327765039912148`*^9, 3.932776505324009*^9}, 3.932776730192276*^9, {
   3.9327768484233055`*^9, 3.9327768674869847`*^9}, {3.932889519414585*^9, 
   3.932889529579906*^9}, {3.932889639975746*^9, 3.932889641205942*^9}, {
   3.9328911301179047`*^9, 3.932891131190918*^9}, {3.932895567743488*^9, 
   3.9328956060014*^9}, {3.932895763306141*^9, 3.932895773751196*^9}},
 CellLabel->"In[17]:=",ExpressionUUID->"3ac4d8a0-20e6-0a41-abc6-24adeca90ed2"],

Cell["Create webpage with puzzle-solving functionality[", "Text",
 CellChangeTimes->{{3.9329120834823704`*^9, 3.9329121239740906`*^9}, 
   3.9329121575642776`*^9},ExpressionUUID->"3153967b-c782-034d-a9d2-\
0e89231220ec"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CloudDeploy", "[", 
  RowBox[{
   RowBox[{"DynamicModule", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"cubeSize", "=", "3"}], ",", 
       RowBox[{"pieces", "=", 
        RowBox[{"{", "}"}]}], ",", 
       RowBox[{"currentPiece", "=", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"False", ",", 
          RowBox[{"{", 
           RowBox[{"3", ",", "3", ",", "3"}], "}"}]}], "]"}]}], ",", 
       RowBox[{"pieceGraphics", "=", 
        RowBox[{"{", "}"}]}], ",", 
       RowBox[{"solutionGraphic", "=", "Nothing"}], ",", 
       RowBox[{"solution2DGraphic", "=", "Nothing"}], ",", 
       RowBox[{"colors", "=", 
        RowBox[{"ColorData", "[", "97", "]"}]}]}], "}"}], ",", 
     RowBox[{"Column", "[", 
      RowBox[{"{", 
       RowBox[{"(*", 
        RowBox[{"Cube", " ", "size", " ", "selection"}], "*)"}], 
       RowBox[{
        RowBox[{"\"\<Cube Size: \>\"", "<>", 
         RowBox[{"ToString", "[", "cubeSize", "]"}]}], ",", 
        RowBox[{"(*", 
         RowBox[{
         "3", "x3x3", " ", "grid", " ", "for", " ", "piece", " ", 
          "creation"}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"Pane", "[", 
         RowBox[{
          RowBox[{"Grid", "[", 
           RowBox[{"{", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"Grid", "[", 
               RowBox[{
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{"With", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"i", "=", "i"}], ",", 
                    RowBox[{"j", "=", "j"}], ",", 
                    RowBox[{"k", "=", "k"}]}], "}"}], ",", 
                    RowBox[{"Toggler", "[", 
                    RowBox[{
                    RowBox[{"Dynamic", "[", 
                    RowBox[{"currentPiece", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "j", ",", "i"}], "]"}], "]"}], "]"}], 
                    ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"False", "->", "Gray"}], ",", 
                    RowBox[{"True", "->", "Yellow"}]}], "}"}], ",", 
                    RowBox[{"ContentPadding", "->", "False"}]}], "]"}]}], 
                   "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", "3"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"j", ",", "3"}], "}"}]}], "]"}], ",", 
                RowBox[{"Spacings", "->", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "0"}], "}"}]}], ",", 
                RowBox[{"ItemSize", "->", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", "1"}], "}"}]}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"k", ",", "3"}], "}"}]}], "]"}], "}"}], "]"}], ",", 
          RowBox[{"ImageSize", "->", 
           RowBox[{"{", 
            RowBox[{"150", ",", "50"}], "}"}]}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Submit", " ", "piece", " ", "button"}], "*)"}], 
        RowBox[{"Button", "[", 
         RowBox[{"\"\<Submit Piece\>\"", ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"Or", "@@", 
             RowBox[{"Flatten", "[", "currentPiece", "]"}]}], ",", 
            RowBox[{
             RowBox[{"AppendTo", "[", 
              RowBox[{"pieces", ",", "currentPiece"}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"AppendTo", "[", 
              RowBox[{"pieceGraphics", ",", 
               RowBox[{"Graphics3D", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Opacity", "[", "0.8", "]"}], ",", 
                   RowBox[{"colors", "[", 
                    RowBox[{"Length", "[", "pieces", "]"}], "]"}], ",", 
                   RowBox[{"MapIndexed", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"#1", "==", "True"}], ",", 
                    RowBox[{"Cube", "[", 
                    RowBox[{
                    RowBox[{"Reverse", "[", "#2", "]"}], "-", 
                    RowBox[{"1", "/", "2"}]}], "]"}], ",", "Nothing"}], "]"}],
                     "&"}], ",", "currentPiece", ",", 
                    RowBox[{"{", "3", "}"}]}], "]"}]}], "}"}], ",", 
                 RowBox[{"ImageSize", "->", "Small"}]}], "]"}]}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"currentPiece", "=", 
              RowBox[{"ConstantArray", "[", 
               RowBox[{"False", ",", 
                RowBox[{"{", 
                 RowBox[{"3", ",", "3", ",", "3"}], "}"}]}], "]"}]}]}]}], 
           "]"}], ",", 
          RowBox[{"ImageSize", "->", "Medium"}]}], "]"}], ",", 
        RowBox[{"(*", 
         RowBox[{"Display", " ", "created", " ", "pieces"}], "*)"}], 
        RowBox[{"Dynamic", "[", 
         RowBox[{"Row", "[", 
          RowBox[{"pieceGraphics", ",", 
           RowBox[{"Spacer", "[", "10", "]"}]}], "]"}], "]"}], ",", 
        RowBox[{"(*", 
         RowBox[{"Solve", " ", "button"}], "*)"}], 
        RowBox[{"Button", "[", 
         RowBox[{"\"\<Solve Puzzle\>\"", ",", 
          RowBox[{"Module", "[", 
           RowBox[{
            RowBox[{"{", "solution", "}"}], ",", 
            RowBox[{
             RowBox[{"solution", "=", 
              RowBox[{"solvePuzzle", "[", 
               RowBox[{"pieces", ",", "cubeSize"}], "]"}]}], ";", 
             RowBox[{"solutionGraphic", "=", 
              RowBox[{"Graphics3D", "[", 
               RowBox[{
                RowBox[{"Prepend", "[", 
                 RowBox[{
                  RowBox[{"Table", "[", 
                   RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"MapIndexed", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"#1", "==", "n"}], ",", 
                    RowBox[{"Cube", "[", 
                    RowBox[{
                    RowBox[{"Reverse", "[", "#2", "]"}], "-", 
                    RowBox[{"1", "/", "2"}]}], "]"}], ",", "Nothing"}], "]"}],
                     "&"}], ",", "solution", ",", 
                    RowBox[{"{", "3", "}"}]}], "]"}], ",", 
                    RowBox[{"colors", "[", "n", "]"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"n", ",", 
                    RowBox[{"Length", "[", "pieces", "]"}]}], "}"}]}], "]"}], 
                  ",", 
                  RowBox[{"EdgeForm", "[", "None", "]"}]}], "]"}], ",", 
                RowBox[{"ImageSize", "->", "Medium"}]}], "]"}]}], ";", 
             RowBox[{"solution2DGraphic", "=", 
              RowBox[{"Column", "[", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"Graphics", "[", 
                  RowBox[{"Flatten", "[", 
                   RowBox[{"Table", "[", 
                    RowBox[{
                    RowBox[{"Style", "[", 
                    RowBox[{
                    RowBox[{"Rectangle", "[", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "j"}], "}"}], "]"}], ",", 
                    RowBox[{"colors", "[", 
                    RowBox[{"solution", "[", 
                    RowBox[{"[", 
                    RowBox[{"k", ",", "j", ",", "i"}], "]"}], "]"}], "]"}]}], 
                    "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "cubeSize"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"j", ",", "cubeSize"}], "}"}]}], "]"}], "]"}], 
                  "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"k", ",", "cubeSize"}], "}"}]}], "]"}], "]"}]}], 
             ";"}]}], "\[IndentingNewLine]", "]"}], ",", 
          RowBox[{"ImageSize", "->", "Medium"}]}], "]"}], ",", 
        RowBox[{"Dynamic", "[", 
         RowBox[{"Row", "[", 
          RowBox[{"{", 
           RowBox[{"solutionGraphic", ",", "solution2DGraphic"}], "}"}], 
          "]"}], "]"}]}], "}"}], "]"}]}], "]"}], ",", 
   "\"\<puzzle-cube-solver\>\""}], "]"}]], "Input",
 CellChangeTimes->{
  3.9325934369986*^9, {3.9325936348499527`*^9, 3.9325936468082504`*^9}, {
   3.932719332856804*^9, 3.93271943648736*^9}, {3.93271948035996*^9, 
   3.932719480909588*^9}, {3.932720213001253*^9, 3.932720258825144*^9}, {
   3.932721564185896*^9, 3.9327216101539993`*^9}, {3.932721653459276*^9, 
   3.932721709952433*^9}, {3.932722528567707*^9, 3.932722550404838*^9}, {
   3.932722653219881*^9, 3.932722683855877*^9}, {3.932722726605047*^9, 
   3.932722761122*^9}, 3.932722835811468*^9, 3.932722875670568*^9, {
   3.932725217090044*^9, 3.932725245239002*^9}, {3.932725524526228*^9, 
   3.932725564239561*^9}, {3.932726008316326*^9, 3.932726011648739*^9}, {
   3.932726118237959*^9, 3.932726137901193*^9}, {3.9327293540661373`*^9, 
   3.9327293688471985`*^9}, 3.93272944675119*^9, {3.9327295568840675`*^9, 
   3.932729557530794*^9}, {3.932729913024851*^9, 3.932729935521204*^9}, {
   3.932729966238666*^9, 3.9327299720007477`*^9}, {3.932731754895172*^9, 
   3.932731760853958*^9}, {3.932731791598429*^9, 3.9327318134910583`*^9}, {
   3.932731880707707*^9, 3.932731887652851*^9}, {3.9327320192987194`*^9, 
   3.9327320233870983`*^9}, {3.932732451382458*^9, 3.932732453490532*^9}, {
   3.932732524290199*^9, 3.932732534729385*^9}, {3.93273585497384*^9, 
   3.932735858174362*^9}, {3.932736021844669*^9, 3.932736028440674*^9}, {
   3.9327423248253937`*^9, 3.932742333081957*^9}, {3.932742430019739*^9, 
   3.9327424339809074`*^9}, {3.932898235457432*^9, 3.932898236636715*^9}, {
   3.932898299427654*^9, 3.932898306670749*^9}, {3.932898696781345*^9, 
   3.932898724859396*^9}, {3.932898932561607*^9, 3.932898939537498*^9}, {
   3.932898985221399*^9, 3.9328990210376806`*^9}, {3.932899567175838*^9, 
   3.93289964365266*^9}, {3.932899685013235*^9, 3.932899712899589*^9}, {
   3.932900156382807*^9, 3.932900179878931*^9}, {3.932900574177639*^9, 
   3.932900575592394*^9}, {3.932900634610023*^9, 3.932900647522913*^9}, {
   3.932901229109489*^9, 3.932901236284336*^9}, {3.932901286345713*^9, 
   3.932901407231413*^9}, {3.93290144522336*^9, 3.9329014638359165`*^9}, {
   3.932901498605623*^9, 3.9329015040036483`*^9}, {3.9329032428972282`*^9, 
   3.932903270960232*^9}, {3.93290333447068*^9, 3.9329033371545525`*^9}, {
   3.932903595294143*^9, 3.9329036425703106`*^9}, {3.932903714401358*^9, 
   3.932903753034324*^9}, {3.932903787456772*^9, 3.932903858638502*^9}, {
   3.932904302859431*^9, 3.932904322761011*^9}, {3.932904357938051*^9, 
   3.9329043810815926`*^9}, {3.9329045413890347`*^9, 
   3.9329045606546307`*^9}, {3.932904608081734*^9, 3.932904616217609*^9}, {
   3.932905269071541*^9, 3.932905333093508*^9}, {3.932905834096855*^9, 
   3.932905835636453*^9}, {3.932907936710855*^9, 3.9329079454260025`*^9}, {
   3.9329079982320976`*^9, 3.9329080030156336`*^9}, {3.932908117669576*^9, 
   3.932908160320492*^9}, {3.9329082083968167`*^9, 3.932908328312454*^9}, {
   3.932909265369501*^9, 3.932909290014791*^9}, {3.932909724807813*^9, 
   3.9329097534762077`*^9}, {3.9329109718595333`*^9, 3.932911000100027*^9}, {
   3.9329120023192616`*^9, 3.932912078001667*^9}, {3.932915073317568*^9, 
   3.9329150899158535`*^9}},
 CellLabel->"In[20]:=",ExpressionUUID->"228aba04-5766-5243-a2bc-2965c578ee4b"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"CloudObject", "[", 
   TemplateBox[{
    "\"https://www.wolframcloud.com/obj/curranflanders/puzzle-cube-solver\"", 
     "https://www.wolframcloud.com/obj/curranflanders/puzzle-cube-solver"},
    "HyperlinkURL"], "]"}],
  CloudObject[
  "https://www.wolframcloud.com/obj/curranflanders/puzzle-cube-solver"],
  SelectWithContents->True]], "Output",
 CellChangeTimes->{3.932912796328615*^9, 3.932915095773876*^9},
 CellLabel->"Out[20]=",ExpressionUUID->"e462cd55-1391-5d4d-a51f-944f79fa7a84"]
}, Open  ]]
},
WindowSize->{606, 596.4},
WindowMargins->{{Automatic, 250.80000000000007`}, {12, Automatic}},
FrontEndVersion->"14.0 for Microsoft Windows (64-bit) (December 12, 2023)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"00f5023f-9517-6449-998e-904b4e1c5ed4"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 445, 8, 68, "Code",ExpressionUUID->"ae7dbb3d-f3e9-ba47-bdae-55be73e79ce4"],
Cell[1028, 32, 7798, 192, 38, "Output",ExpressionUUID->"cc9648ac-43ac-5f43-b6b4-495332361dcf"]
}, Open  ]],
Cell[8841, 227, 4153, 100, 261, "Code",ExpressionUUID->"bb04d7e6-964c-c94a-8f7d-be03ae2f732e"],
Cell[12997, 329, 1686, 47, 86, "Code",ExpressionUUID->"62d7a02c-fbd2-1c48-846b-a956741c7f84"],
Cell[14686, 378, 8482, 184, 226, "Code",ExpressionUUID->"916de741-14fb-3949-914a-f3cb10979ab2"],
Cell[23171, 564, 1636, 42, 138, "Code",ExpressionUUID->"5edbcc78-926b-204f-9acb-ce5dfa5a57fd"],
Cell[24810, 608, 1765, 35, 156, "Code",ExpressionUUID->"7c8621e4-93fa-b14d-87c3-c17d763876f1"],
Cell[26578, 645, 1715, 39, 68, "Code",ExpressionUUID->"0a90f1ad-476e-2e4f-8231-a689c0735d4b"],
Cell[28296, 686, 1672, 33, 68, "Code",ExpressionUUID->"8a4e95b6-305b-a441-8d47-288c6de76ecf"],
Cell[29971, 721, 3537, 75, 244, "Code",ExpressionUUID->"3ac4d8a0-20e6-0a41-abc6-24adeca90ed2"],
Cell[33511, 798, 220, 3, 35, "Text",ExpressionUUID->"3153967b-c782-034d-a9d2-0e89231220ec"],
Cell[CellGroupData[{
Cell[33756, 805, 11630, 242, 866, "Input",ExpressionUUID->"228aba04-5766-5243-a2bc-2965c578ee4b"],
Cell[45389, 1049, 535, 11, 56, "Output",ExpressionUUID->"e462cd55-1391-5d4d-a51f-944f79fa7a84"]
}, Open  ]]
}
]
*)

